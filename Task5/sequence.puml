@startuml
title Процесс обработки заявки на кредит (MVP)

actor Клиент as Client
participant "Сайт / Интернет-банк" as Front
participant "CAS\n(Credit Application Service)" as CAS
participant "Скоринг" as Scoring
participant "Кредитный конвейер" as Conveyor
participant "АБС" as ABS
participant "СМС-шлюз" as SMS

== Подача заявки ==
Client -> Front : Заполняет форму заявки (ФИО, паспорт, сумма)
Front -> CAS : POST /applications (HTTPS)
CAS -> Scoring : Запрос предварительного скоринга (API)
Scoring --> CAS : Оценка / предварительное решение
CAS -> Client : Отображает "Предварительное решение" или "Отказ"
CAS -> SMS : Отправить СМС о получении заявки
SMS --> Client : СМС: "Заявка получена, ожидайте решение"

== Пакетный обмен (раз в сутки) ==
CAS -> Conveyor : Передаёт заявки для рассмотрения\n(Batch, 1×/сутки)
Conveyor -> Scoring : Запрос скоринга для каждой заявки (онлайн)
Scoring --> Conveyor : Результаты скоринга (оценка риска)
Conveyor -> Conveyor : Принятие решения сотрудником / системой
Conveyor -> ABS : Передаёт результаты рассмотрения\n(одобрено / отказ, Batch 1×/сутки)
ABS -> ABS : Обработка одобренных заявок, создание договоров, проводки

== Рассылка статусов ==
ABS --> Conveyor : Подтверждение обработки (Batch)
Conveyor --> CAS : Возврат статусов заявок (Batch, 1×/сутки)
CAS -> CAS : Обновление статусов в БД
CAS -> SMS : Отправка уведомлений клиентам
alt Одобрено
  SMS --> Client : "Заявка одобрена, приходите на идентификацию"
else Отказ
  SMS --> Client : "К сожалению, заявка отклонена"
end

== Завершение процесса ==
Client -> ABS : Приходит в отделение для идентификации (KYC)
ABS -> ABS : Проверка личности и зачисление кредита
ABS --> CAS : (опционально) Финальный статус "Выдача завершена" (Batch)
CAS -> SMS : СМС клиенту о зачислении средств
SMS --> Client : "Кредит зачислен на счёт"

@enduml
